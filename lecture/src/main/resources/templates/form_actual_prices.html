<section class="main special">
    <header class="major">
        <h2>Select Instrument for Actual Price</h2>
    </header>
    <form id="actual-price-form" th:action="@{/forex-actprice}" th:object="${messageActPrice}" method="post">
        <div class="field">
            <label for="instrument">Instrument:</label>
            <select id="instrument" th:field="*{instrument}">
                <option th:each="inst : ${instruments}" th:value="${inst}" th:text="${inst}"></option>
            </select>
        </div>
        <ul class="actions special">
            <li><input type="submit" value="Get Price" class="primary" /></li>
        </ul>
    </form>
    <div id="actual-price-results">
        <!-- Results will be loaded here -->
    </div>
</section>

<script>
    // This script will be executed when the fragment is loaded
    $(document).ready(function() {
        $('#actual-price-form').on('submit', function(e) {
            e.preventDefault(); // Prevent default form submission

            var form = $(this);
            var url = form.attr('action');
            var method = form.attr('method');
            var formData = form.serialize(); // Get form data

            // Show a loading message
            $('#actual-price-results').html('<p>Fetching price...</p>');

            $.ajax({
                url: url,
                method: method,
                data: formData,
                success: function(response) {
                    // Inject the response (which will be the result_actual_prices fragment)
                    $('#actual-price-results').html(response);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    $('#actual-price-results').html('<p style="color: red;">Error getting price: ' + textStatus + '</p>');
                    console.error("Error submitting form:", textStatus, errorThrown);
                }
            });
        });
    });
</script>
